<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>持ち物リスト - ロンドン渡航</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#ffffff">
  <link rel="icon" type="image/svg+xml" href="images/icon.svg">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="stylesheet" href="styles.css">
</head>
<body class="page-checklist">
  <header class="site-header">
    <nav class="site-nav">
      <a href="index.html" class="nav-link nav-home"><i class="fa-solid fa-home"></i></a>
      <a href="schedule.html" class="nav-link"><i class="fa-solid fa-calendar"></i> 日程</a>
      <a href="hotel.html" class="nav-link"><i class="fa-solid fa-hotel"></i> 宿泊</a>
      <a href="flight.html" class="nav-link"><i class="fa-solid fa-plane"></i> フライト</a>
      <a href="spots.html" class="nav-link"><i class="fa-solid fa-camera"></i> 観光</a>
      <a href="match.html" class="nav-link"><i class="fa-solid fa-futbol"></i> 試合</a>
      <a href="info.html" class="nav-link"><i class="fa-solid fa-info-circle"></i> 基本情報</a>
      <a href="phrases.html" class="nav-link"><i class="fa-solid fa-comments"></i> 会話</a>
      <a href="checklist.html" class="nav-link active"><i class="fa-solid fa-check"></i> 持ち物</a>
      <a href="emergency.html" class="nav-link"><i class="fa-solid fa-phone"></i> 緊急</a>
    </nav>
  </header>

  <main class="container">
    <h1 class="page-title">
      <i class="fa-solid fa-check-square"></i> 持ち物チェックリスト
    </h1>

    <!-- 進捗表示 -->
    <div class="card" style="margin-bottom:24px;">
      <div style="display:flex;align-items:center;gap:16px;flex-wrap:wrap;">
        <div style="flex:1;min-width:200px;">
          <div style="font-size:14px;color:var(--text-muted);margin-bottom:8px;">チェック済み</div>
          <div style="font-size:28px;font-weight:900;color:var(--blue);">
            <span id="checkedCount">0</span> / <span id="totalCount">0</span>
          </div>
        </div>
        <div style="flex:2;min-width:200px;">
          <div style="height:12px;background:var(--bg-light);border-radius:6px;overflow:hidden;">
            <div id="progressBar" style="height:100%;background:var(--blue);width:0%;transition:width .3s;"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- チェックリストアクション -->
    <div class="checklist-actions" style="margin-bottom:24px;">
      <button class="checklist-btn" onclick="checkAll()">
        <i class="fa-solid fa-check-double"></i> すべてチェック
      </button>
      <button class="checklist-btn" onclick="uncheckAll()">
        <i class="fa-solid fa-rotate-left"></i> リセット
      </button>
    </div>

    <!-- 重要書類 -->
    <div class="card">
      <h2 class="card-title" style="color:var(--orange);">
        <i class="fa-solid fa-file-circle-check"></i> 重要書類
      </h2>
      <div class="checklist-grid" id="checklist-documents"></div>
    </div>

    <!-- 電子機器 -->
    <div class="card">
      <h2 class="card-title">
        <i class="fa-solid fa-mobile-screen"></i> 電子機器
      </h2>
      <div class="checklist-grid" id="checklist-electronics"></div>
    </div>

    <!-- 衣類・日用品 -->
    <div class="card">
      <h2 class="card-title">
        <i class="fa-solid fa-shirt"></i> 衣類・日用品
      </h2>
      <div class="checklist-grid" id="checklist-clothing"></div>
    </div>

    <!-- お金・カード -->
    <div class="card">
      <h2 class="card-title">
        <i class="fa-solid fa-wallet"></i> お金・カード
      </h2>
      <div class="checklist-grid" id="checklist-money"></div>
    </div>

    <!-- その他 -->
    <div class="card">
      <h2 class="card-title">
        <i class="fa-solid fa-box"></i> その他
      </h2>
      <div class="checklist-grid" id="checklist-other"></div>
    </div>

    <!-- 注意事項 -->
    <div class="alert alert-warning" style="margin-top:24px;">
      <div class="alert-title">
        <i class="fa-solid fa-triangle-exclamation"></i> 忘れずに！
      </div>
      <ul style="margin:12px 0 0;padding-left:20px;font-size:15px;line-height:2;">
        <li><b>UK ETA（電子渡航認証）</b>の申請は済みましたか？</li>
        <li>パスポートの有効期限は十分ありますか？（6ヶ月以上推奨）</li>
        <li>海外旅行保険の加入をお忘れなく</li>
        <li>クレジットカードの海外利用設定は有効ですか？</li>
      </ul>
    </div>
  </main>

  <footer class="site-footer">
    <a href="index.html" class="btn"><i class="fa-solid fa-home"></i> トップへ戻る</a>
  </footer>

  <script>
    // チェックリストのアイテム定義
    const checklistItems = {
      documents: [
        { id: 'passport', label: 'パスポート', icon: 'fa-passport' },
        { id: 'tickets', label: '航空券（eチケット）', icon: 'fa-ticket' },
        { id: 'uketa', label: 'UK ETA（電子渡航認証）', icon: 'fa-file-circle-check' },
        { id: 'insurance', label: '海外旅行保険証', icon: 'fa-shield-halved' },
        { id: 'insurancecard', label: '保険会社緊急連絡カード', icon: 'fa-id-card' },
        { id: 'matchticket', label: '試合チケット', icon: 'fa-futbol' },
        { id: 'hotelconfirm', label: 'ホテル予約確認書', icon: 'fa-hotel' },
        { id: 'embassy', label: '大使館連絡先メモ', icon: 'fa-building-flag' }
      ],
      electronics: [
        { id: 'smartphone', label: 'スマートフォン', icon: 'fa-mobile-screen' },
        { id: 'sim', label: 'SIM / eSIM（海外用）', icon: 'fa-sim-card' },
        { id: 'charger', label: 'スマホ充電器', icon: 'fa-charging-station' },
        { id: 'battery', label: 'モバイルバッテリー', icon: 'fa-battery-full' },
        { id: 'adapter', label: '変換プラグ（BF/Cタイプ）', icon: 'fa-plug' },
        { id: 'camera', label: 'カメラ（必要な方）', icon: 'fa-camera' }
      ],
      clothing: [
        { id: 'jacket', label: '防寒着・上着', icon: 'fa-shirt' },
        { id: 'umbrella', label: '折りたたみ傘', icon: 'fa-umbrella' },
        { id: 'shoes', label: '歩きやすい靴', icon: 'fa-shoe-prints' },
        { id: 'clothes', label: '着替え', icon: 'fa-shirt' },
        { id: 'toiletries', label: '洗面用具', icon: 'fa-pump-soap' }
      ],
      money: [
        { id: 'cash', label: '現金（ポンド/ユーロ）', icon: 'fa-money-bill' },
        { id: 'cards', label: 'クレジットカード', icon: 'fa-credit-card' },
        { id: 'wallet', label: '財布', icon: 'fa-wallet' }
      ],
      other: [
        { id: 'medicine', label: '常備薬', icon: 'fa-pills' },
        { id: 'glasses', label: 'メガネ・コンタクト', icon: 'fa-glasses' },
        { id: 'guidebook', label: 'ガイドブック', icon: 'fa-book' },
        { id: 'bag', label: 'サブバッグ（観光用）', icon: 'fa-bag-shopping' }
      ]
    };

    // LocalStorage操作
    function loadChecklist() {
      const saved = localStorage.getItem('uk-trip-checklist');
      return saved ? JSON.parse(saved) : {};
    }

    function saveChecklist(data) {
      localStorage.setItem('uk-trip-checklist', JSON.stringify(data));
    }

    // チェックリスト描画
    function renderChecklist() {
      const saved = loadChecklist();

      Object.keys(checklistItems).forEach(category => {
        const container = document.getElementById(`checklist-${category}`);
        container.innerHTML = checklistItems[category].map(item => `
          <div class="checklist-item ${saved[item.id] ? 'checked' : ''}" onclick="toggleItem('${item.id}')">
            <input type="checkbox" id="${item.id}" ${saved[item.id] ? 'checked' : ''} aria-label="${item.label}">
            <label for="${item.id}">
              <i class="fa-solid ${item.icon}"></i>
              ${item.label}
            </label>
          </div>
        `).join('');
      });

      updateProgress();
    }

    // アイテム切り替え
    function toggleItem(id) {
      const saved = loadChecklist();
      saved[id] = !saved[id];
      saveChecklist(saved);
      renderChecklist();
    }

    // すべてチェック
    function checkAll() {
      const saved = {};
      Object.keys(checklistItems).forEach(category => {
        checklistItems[category].forEach(item => {
          saved[item.id] = true;
        });
      });
      saveChecklist(saved);
      renderChecklist();
    }

    // リセット
    function uncheckAll() {
      saveChecklist({});
      renderChecklist();
    }

    // 進捗更新
    function updateProgress() {
      const saved = loadChecklist();
      let total = 0;
      let checked = 0;

      Object.keys(checklistItems).forEach(category => {
        checklistItems[category].forEach(item => {
          total++;
          if (saved[item.id]) checked++;
        });
      });

      document.getElementById('checkedCount').textContent = checked;
      document.getElementById('totalCount').textContent = total;
      document.getElementById('progressBar').style.width = `${(checked / total) * 100}%`;
    }

    // 初期化
    renderChecklist();

    // Service Worker
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js');
    }
  </script>
</body>
</html>
